import{_ as z}from"./alert.b8f6e1e0.js";import{_ as F,d as T,l as X,u as O,b as h,e as J,t as d,o as r,f as a,h as s,s as m,g as e,w as $,v as Q,i as I,F as y,j as B,k as _,n as Z,m as V,p as v,q as H,x as K,a1 as W,a2 as Y}from"./index.f9849cfc.js";import{u as ee}from"./docente.35a77a9f.js";import{r as te}from"./CheckIcon.70ea120a.js";const u=k=>(W("data-v-946f6b9a"),k=k(),Y(),k),se={key:0,class:"fullscreen-loader"},oe=u(()=>e("div",{class:"loader-content"},[e("div",{class:"spinner"}),e("p",{class:"loading-text"},"Generando...")],-1)),re=[oe],ae={key:1,class:"fullscreen-loader"},ne=u(()=>e("div",{class:"loader-content"},[e("div",{class:"spinner"}),e("p",{class:"loading-text"},"Buscando...")],-1)),ie=[ne],le={class:"flex flex-col"},de={class:"flex-1"},ce={class:"py-6"},ue=u(()=>e("div",{class:"uppercase font-bold text-xl border-b-2 mb-6"},[e("h1",null,"Acta de Notas Periodo Acad\xE9mico")],-1)),_e=["value"],me={key:0,class:"py-6"},fe={class:"max-w-7xl mx-auto px-4 sm:px-6 md:px-8"},pe={class:"flex items-center justify-center","aria-label":"Progress"},ge={role:"list",class:"flex items-center"},he=u(()=>e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"h-0.5 w-full bg-indigo-600"})],-1)),be={class:"relative w-8 h-8 flex items-center justify-center bg-indigo-600 rounded-full hover:bg-indigo-900"},xe={class:"sr-only"},ye=u(()=>e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"h-0.5 w-full bg-gray-200"})],-1)),ve={href:"#",class:"relative w-8 h-8 flex items-center justify-center bg-white border-2 border-indigo-600 rounded-full","aria-current":"step"},we=u(()=>e("span",{class:"h-2.5 w-2.5 bg-indigo-600 rounded-full","aria-hidden":"true"},null,-1)),ke={class:"sr-only"},Pe=u(()=>e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"h-0.5 w-full bg-gray-200"})],-1)),Be={href:"#",class:"group relative w-8 h-8 flex items-center justify-center bg-white border-2 border-gray-300 rounded-full hover:border-gray-400"},Ee=u(()=>e("span",{class:"h-2.5 w-2.5 bg-transparent rounded-full group-hover:bg-gray-300","aria-hidden":"true"},null,-1)),Ce={class:"sr-only"},Se={key:0},Ae={class:"min-w-0 flex-1 text-md"},$e=["for"],je=u(()=>e("br",null,null,-1)),De=u(()=>e("br",null,null,-1)),Ne={class:"ml-3 flex items-center h-5"},Ie=["id","value"],Ve={class:"mt-6 flex"},Ue={key:1},Me={class:"px-4 sm:px-6 lg:px-8"},Ge={class:"sm:flex sm:items-center"},Le={class:"sm:flex-auto"},Re=u(()=>e("h1",{class:"text-2xl font-semibold text-gray-800"}," ALUMNOS ",-1)),qe={class:"flex flex-row items-center w-full text-xl my-4"},ze={as:"span",class:"font-medium text-gray-900 w-9/12"},Fe={as:"span",class:"font-medium text-gray-900 w-3/12"},Te={class:"flex flex-row items-center w-full text-lg my-4"},Xe={key:0,as:"span",class:"font-medium text-gray-900 w-4/12"},Oe=u(()=>e("span",{class:"text-blue-500"},"Sin Publicar",-1)),Je={key:1,as:"span",class:"font-medium text-gray-900 w-4/12"},Qe=u(()=>e("span",{class:"text-green-500"},"Publicado",-1)),Ze={key:2,as:"span",class:"font-medium text-gray-900 w-4/12"},He=u(()=>e("span",{class:"text-red-500"},"Acta Cerrada",-1)),Ke={class:"sm:flex sm:items-center justify-end"},We={class:"mt-4 sm:mt-0 sm:ml-16 sm:flex-none"},Ye=["disabled"],et={class:"mt-4 flex flex-col"},tt={class:"-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8"},st={class:"inline-block min-w-full py-2 align-middle md:px-6 lg:px-8"},ot={class:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg"},rt={class:"min-w-full divide-y divide-gray-300"},at=u(()=>e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"py-3.5 pl-4 pr-3 text-sm font-semibold text-gray-900 sm:pl-6 text-center"}," N\xB0 "),e("th",{scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6"}," Alumno "),e("th",{scope:"col",class:"px-3 py-3.5 text-sm font-semibold text-gray-900 text-center"}," N\xB0 Documento "),e("th",{scope:"col",class:"px-3 py-3.5 text-sm font-semibold text-gray-900 text-center"}," Promedio Final ")])],-1)),nt={class:"divide-y divide-gray-200 bg-white"},it={class:"whitespace-nowrap px-3 py-2 text-sm text-gray-500 text-center"},lt={class:"text-gray-900"},dt={class:"whitespace-nowrap py-2 pl-4 pr-3 text-sm sm:pl-6"},ct={class:"flex items-center"},ut={class:"h-10 w-10 flex-shrink-0"},_t=["src"],mt={class:"ml-4"},ft={class:"font-medium text-gray-900"},pt={class:"whitespace-nowrap px-3 py-2 text-sm text-gray-500 text-center"},gt={class:"text-gray-900"},ht={key:0,class:"whitespace-nowrap px-3 py-2 text-sm text-gray-700 text-center"},bt={class:"text-gray-900 font-bold"},xt={key:1,class:"whitespace-nowrap px-3 py-2 text-sm text-gray-700 text-center"},yt=["onUpdate:modelValue","disabled"],vt={class:"mt-6 flex"},wt={key:1,class:"py-6"},kt=T({__name:"notas",setup(k){const j=X(),i=ee(),w=O(),D=h(!1),f=h(0),E=h(""),C=h(""),b=h(!1),p=h(!1),P=h(!1),S=h(!1),x=h([{id:"01",name:"Cursos",description:"",href:"",status:"current"},{id:"02",name:"Notas",description:"",href:"notas",status:"upcoming"}]),c=h(0);J(async()=>{await w.get_periodo_active(),await w.get_periodos_by_docente_id(),w.periodos.length>0&&(c.value=w.periodos[w.periodos.length-1].id);const{status:n}=await i.get_cursos_by_docente(c.value);n!==200?d("Error al obtener los cursos",{type:"danger",position:"top-right",hideProgressBar:!0}):D.value=!0});const U=async n=>{if(n===0){d("Error, Debe seleccionar un  curso para continuar",{type:"danger",hideProgressBar:!0});return}x.value[0].status="complete",x.value[1].status="current",C.value=i.cursos_docente.filter(t=>t.id==n)[0].grupo,E.value=i.cursos_docente.filter(t=>t.id==n)[0].curso_nombre;const{data:o}=await i.get_estado_notas_curso_by_id(n,c.value);b.value=o.is_publicado,p.value=o.is_cerrado;const{status:l}=await i.get_alumnos_by_curso(n);l!==200&&d("Error al obtener Datos",{type:"danger",hideProgressBar:!0})},M=()=>{x.value[1].status="upcoming",x.value[0].status="current",i.alumnos_curso=[],f.value=0,C.value="",E.value=""},N=async(n,o)=>{if(n===0){d("Error, Debe seleccionar un  curso para continuar",{type:"danger",hideProgressBar:!0});return}const{status:l}=await i.save_notas(n,c.value,o);l!==200?d("Error al guardar notas,verifique que todos los campos sean correctos",{type:"danger",hideProgressBar:!0}):d("Notas guardadas correctamente",{type:"success",hideProgressBar:!0})},G=async n=>{for(let l=0;l<i.alumnos_curso.length;l++)if(i.alumnos_curso[l].promedio_final===null){d("Error, Debe ingresar notas para todos los alumnos",{type:"danger",hideProgressBar:!0});return}if(n===0){d("Error, Debe seleccionar un  curso para continuar",{type:"danger",hideProgressBar:!0});return}const{status:o}=await i.publicar_notas(n,c.value);if(o!==200)d("Error al publicar notas",{type:"danger",hideProgressBar:!0});else{d("Notas publicadas correctamente",{type:"success",hideProgressBar:!0});const{data:l}=await i.get_estado_notas_curso_by_id(n,c.value);b.value=l.is_publicado,p.value=l.is_cerrado}},L=async n=>{if(n===0){d("Error, Debe seleccionar un  curso para continuar",{type:"danger",hideProgressBar:!0});return}const{status:o}=await i.cerrar_acta(n,c.value);if(o!==200)d("Error al cerrar acta",{type:"danger",hideProgressBar:!0});else{d("Acta cerrada correctamente",{type:"success",hideProgressBar:!0});const{data:l}=await i.get_estado_notas_curso_by_id(n,c.value);b.value=l.is_publicado,p.value=l.is_cerrado;const{status:t}=await i.get_alumnos_by_curso(n);t!==200&&d("Error al obtener Datos",{type:"danger",hideProgressBar:!0})}},R=async n=>{P.value=!0;try{const{status:o,data:l,error:t}=await j.get_reporte_actanotas_pdf(n,c.value);if(o!==200||!(l!=null&&l.path)){d(t||"Error al generar el acta",{type:"danger",hideProgressBar:!0});return}const g=document.createElement("a");g.target="_blank",g.href=l.path,g.click()}catch(o){console.error("Error en eventImprimirActa:",o),d("Error inesperado al imprimir el acta",{type:"danger",hideProgressBar:!0})}finally{P.value=!1}},q=async n=>{S.value=!0;try{c.value=n;const{status:o}=await i.get_cursos_by_docente(c.value);o!==200?d("Error al obtener los cursos",{type:"danger",position:"top-right",hideProgressBar:!0}):D.value=!0}catch{d("Error al obtener los cursos",{type:"danger",position:"top-right",hideProgressBar:!0})}finally{S.value=!1}};return(n,o)=>{const l=z;return r(),a(y,null,[s(P)?(r(),a("div",se,re)):m("",!0),s(S)?(r(),a("div",ae,ie)):m("",!0),e("div",le,[e("main",de,[e("div",ce,[ue,$(e("select",{"onUpdate:modelValue":o[0]||(o[0]=t=>I(c)?c.value=t:null),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",onChange:o[1]||(o[1]=t=>q(s(c)))},[(r(!0),a(y,null,B(s(w).periodos,t=>(r(),a("option",{key:t.id,value:t.id},_(t.nombre),9,_e))),128))],544),[[Q,s(c)]])]),s(i).cursos_docente.length>0?(r(),a("div",me,[e("div",fe,[e("nav",pe,[e("ol",ge,[(r(!0),a(y,null,B(s(x),(t,g)=>(r(),a("li",{key:t.name,class:Z(["relative",[g!==s(x).length-1?"pr-8 sm:pr-20":""]])},[t.status==="complete"?(r(),a(y,{key:0},[he,e("a",be,[V(s(te),{class:"w-5 h-5 text-white","aria-hidden":"true"}),e("span",xe,_(t.name),1)])],64)):t.status==="current"?(r(),a(y,{key:1},[ye,e("a",ve,[we,e("span",ke,_(t.name),1)])],64)):(r(),a(y,{key:2},[Pe,e("a",Be,[Ee,e("span",Ce,_(t.name),1)])],64))],2))),128))])]),s(x)[0].status==="current"?(r(),a("div",Se,[(r(!0),a(y,null,B(s(i).cursos_docente,(t,g)=>(r(),a("div",{key:g,class:"relative flex items-start py-4 border rounded-lg px-4 my-2"},[e("div",Ae,[e("label",{for:`check-${t.id}`,class:"font-medium text-gray-700 w-full"},[e("b",null,[v(_(t.curso_nombre)+" ("+_(t.grupo)+") ",1),je,v(_(t.programa_nombre),1),De,v("RESOLUCI\xD3N: "+_(t.resolucion),1)])],8,$e)]),e("div",Ne,[$(e("input",{id:`-${t.id}`,"onUpdate:modelValue":o[2]||(o[2]=A=>I(f)?f.value=A:null),type:"radio",name:"radio",value:`${t.id}`,"aria-describedby":"comments-description",class:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 rounded"},null,8,Ie),[[H,s(f)]])])]))),128)),e("div",Ve,[e("button",{class:"mx-auto flex-shrink-0 px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:o[3]||(o[3]=t=>U(s(f)))}," Continuar ")])])):m("",!0),s(x)[1].status==="current"?(r(),a("div",Ue,[e("div",Me,[e("div",Ge,[e("div",Le,[Re,e("div",qe,[e("p",ze,[v(" Curso: "),e("b",null,_(s(E)),1)]),e("p",Fe,[v(" Grupo: "),e("b",null,_(s(C)),1)])]),e("div",Te,[s(b)===!1&&s(p)===!1?(r(),a("p",Xe,[v(" Estado: "),Oe])):m("",!0),s(b)===!0&&s(p)===!1?(r(),a("p",Je,[v(" Estado: "),Qe])):m("",!0),s(b)===!0&&s(p)===!0?(r(),a("p",Ze,[v(" Estado: "),He])):m("",!0)])])]),e("div",Ke,[e("div",We,[s(p)===!1?(r(),a("button",{key:0,class:"mx-2 inline-flex items-center justify-center rounded-md border border-transparent bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 sm:w-auto",onClick:o[4]||(o[4]=t=>N(s(f),s(i).alumnos_curso))}," Guardar ")):m("",!0),s(b)===!1?(r(),a("button",{key:1,class:"mx-2 inline-flex items-center justify-center rounded-md border border-transparent bg-green-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 sm:w-auto",onClick:o[5]||(o[5]=t=>G(s(f)))}," Publicar ")):m("",!0),s(b)===!0&&s(p)===!1?(r(),a("button",{key:2,class:"mx-2 inline-flex items-center justify-center rounded-md border border-transparent bg-yellow-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-offset-2 sm:w-auto",onClick:o[6]||(o[6]=t=>L(s(f)))}," Cerrar Acta ")):m("",!0),s(p)===!0?(r(),a("button",{key:3,type:"button",disabled:s(P),class:"mx-2 inline-flex items-center justify-center rounded-md border border-transparent bg-green-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 sm:w-auto",onClick:o[7]||(o[7]=t=>R(s(f)))}," Imprimir Acta ",8,Ye)):m("",!0),e("button",{type:"button",class:"mx-2 inline-flex items-center justify-center rounded-md border border-transparent bg-red-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 sm:w-auto",onClick:o[8]||(o[8]=t=>M())}," Atras ")])]),e("div",et,[e("div",tt,[e("div",st,[e("div",ot,[e("table",rt,[at,e("tbody",nt,[(r(!0),a(y,null,B(s(i).alumnos_curso,(t,g)=>(r(),a("tr",{key:g},[e("td",it,[e("div",lt,_(g+1),1)]),e("td",dt,[e("div",ct,[e("div",ut,[e("img",{class:"h-8 w-8 rounded-full",src:t.foto?s(j).get_media_url(t.foto):"https://th.bing.com/th/id/R.e62421c9ba5aeb764163aaccd64a9583?rik=DzXjlnhTgV5CvA&riu=http%3a%2f%2fcdn.onlinewebfonts.com%2fsvg%2fimg_210318.png&ehk=952QCsChZS0znBch2iju8Vc%2fS2aIXvqX%2f0zrwkjJ3GA%3d&risl=&pid=ImgRaw&r=0",alt:""},null,8,_t)]),e("div",mt,[e("div",ft,_(`${t.apellido_paterno} ${t.apellido_materno}, ${t.nombres}`),1)])])]),e("td",pt,[e("div",gt,_(t.numero_documento),1)]),t.is_cerrado?(r(),a("td",ht,[e("div",bt,_(t.promedio_final),1)])):(r(),a("td",xt,[$(e("input",{"onUpdate:modelValue":A=>t.promedio_final=A,type:"text",max:20,min:0,step:.01,disabled:t.is_cerrado,class:"focus:ring-blue-500 h-6 w-20 md:w-4/12 border-gray-700 rounded"},null,8,yt),[[K,t.promedio_final]])]))]))),128))])])])])])])]),e("div",vt,[s(p)===!1?(r(),a("button",{key:0,class:"mx-auto flex-shrink-0 px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",onClick:o[9]||(o[9]=t=>N(s(f),s(i).alumnos_curso))}," Guardar ")):m("",!0)])])):m("",!0)])])):(r(),a("div",wt,[V(l,{message:"El Docente no tiene Cursos activos en este  periodo"})]))])])],64)}}});var St=F(kt,[["__scopeId","data-v-946f6b9a"]]);export{St as default};
