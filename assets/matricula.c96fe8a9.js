import{_ as O}from"./alert.b8f6e1e0.js";import{d as H,b as h,u as A,a0 as q,l as G,h as t,o as a,f as o,g as e,F as f,j as $,n as p,m as x,k as c,s as S,B,c as L,p as V,t as k,z as T,a as J,e as K,r as Q,w as W,v as X,i as Y,C as Z}from"./index.f9849cfc.js";import{r as ee}from"./CheckIcon.70ea120a.js";import{O as se,k as te,E as z,h as ae}from"./radio-group.37d57e2a.js";const oe={key:0,class:"flex flex-col"},re={class:"flex-1"},ie={class:"py-6"},ne={class:"max-w-7xl mx-auto px-4 sm:px-6 md:px-8"},le={class:"flex items-center justify-center","aria-label":"Progress"},de={role:"list",class:"flex items-center"},ce=e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"h-0.5 w-full bg-indigo-600"})],-1),ue={class:"relative w-8 h-8 flex items-center justify-center bg-indigo-600 rounded-full hover:bg-indigo-900"},me={class:"sr-only"},_e=e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"h-0.5 w-full bg-gray-200"})],-1),ge={href:"#",class:"relative w-8 h-8 flex items-center justify-center bg-white border-2 border-indigo-600 rounded-full","aria-current":"step"},fe=e("span",{class:"h-2.5 w-2.5 bg-indigo-600 rounded-full","aria-hidden":"true"},null,-1),he={class:"sr-only"},pe=e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"h-0.5 w-full bg-gray-200"})],-1),xe={href:"#",class:"group relative w-8 h-8 flex items-center justify-center bg-white border-2 border-gray-300 rounded-full hover:border-gray-400"},ve=e("span",{class:"h-2.5 w-2.5 bg-transparent rounded-full group-hover:bg-gray-300","aria-hidden":"true"},null,-1),be={class:"sr-only"},ye={key:0},ke={class:"divide-y divide-gray-200"},we={class:"min-w-0 flex-1 text-sm"},Ce=["for"],Ee={id:"comments-description",class:"text-gray-500 flex gap-2"},$e={class:"ml-3 flex items-center h-5"},Be=["id","onChange"],Pe={key:1,class:"flex flex-col space-y-4 mt-10"},Me={class:"text-lg leading-6 font-medium text-gray-900 uppercase"},Se={class:"space-y-4"},je={class:"relative block bg-white border rounded-lg shadow-sm px-6 py-4 cursor-pointer sm:flex sm:justify-between focus:outline-none"},De={class:"flex items-center"},Fe={class:"text-sm flex flex-col"},Ne={class:"block sm:inline"},Ve={class:"text-xs"},ze={key:0},Ie=e("span",{class:"text-red-500"},[e("b",null," No hay cupo disponible ")],-1),He=[Ie],Ae={key:1},Ge={class:"font-medium text-gray-900"},Re={class:"ml-1 text-gray-500 sm:ml-0"},I=H({__name:"form-cursos",props:{expediente:{}},emits:["finishMatricula"],setup(F,{emit:i}){const C=F,u=i,m=h([{id:"01",name:"Iniciar",description:"",href:"",status:"complete"},{id:"02",name:"Cursos",description:"",href:"cursos",status:"current"},{id:"03",name:"Horarios",description:"",href:"horarios",status:"upcoming"}]),v=A(),_=q(),E=G(),b=h([]),w=h(!1),l=g=>{b.value.includes(g.id)?b.value=b.value.filter(r=>r!==g.id):b.value.push(g.id)},j=async()=>{if(b.value.length===0)k("Debe selecionar al menos un curso para continuar",{type:"danger",hideProgressBar:!0});else{m.value[1].status="complete",m.value[2].status="current";const{status:g}=await v.get_cursos_grupos_by_cursos(b.value,C.expediente);g!==200&&k("Error al obtener los cursos",{type:"danger",hideProgressBar:!0})}},P=(g,r)=>{if(r.numero_registros>=r.limite_registros){k("El grupo seleccionado ya est\xE1 lleno",{type:"danger",hideProgressBar:!0});return}g.grupos.forEach(s=>{s.checked=!1}),r.checked=!r.checked},M=async()=>{if(w.value)return;w.value=!0;const{status:g}=await v.save_cursos_grupos(C.expediente);if(g!==201){k("Error al guardar los cursos",{type:"danger",hideProgressBar:!0}),w.value=!1;return}k("Matricula Completada Correctamente!",{type:"success",hideProgressBar:!0}),E.get_reporte_matricula_pdf(C.expediente),u("finishMatricula",!0),_.push("/horarios"),w.value=!0};return(g,r)=>t(v).get_cursos_list.length>0?(a(),o("div",oe,[e("main",re,[e("div",ie,[e("div",ne,[e("nav",le,[e("ol",de,[(a(!0),o(f,null,$(t(m),(s,d)=>(a(),o("li",{key:s.name,class:p(["relative",[d!==t(m).length-1?"pr-8 sm:pr-20":""]])},[s.status==="complete"?(a(),o(f,{key:0},[ce,e("a",ue,[x(t(ee),{class:"w-5 h-5 text-white","aria-hidden":"true"}),e("span",me,c(s.name),1)])],64)):s.status==="current"?(a(),o(f,{key:1},[_e,e("a",ge,[fe,e("span",he,c(s.name),1)])],64)):(a(),o(f,{key:2},[pe,e("a",xe,[ve,e("span",be,c(s.name),1)])],64))],2))),128))])]),t(m)[1].status==="current"?(a(),o("div",ye,[e("div",ke,[(a(!0),o(f,null,$(t(v).get_cursos_list,(s,d)=>(a(),o("div",{key:d,class:"relative flex items-start py-4"},[e("div",we,[e("label",{for:`check-${s.id}`,class:"font-medium text-gray-700 w-full"},[e("b",null,c(s.nombre)+" ("+c(s.codigo)+")",1)],8,Ce),e("p",Ee,[e("span",null,"Ciclo: "+c(s.ciclo),1),e("span",null,"Creditos: "+c(s.creditos),1)])]),e("div",$e,[e("input",{id:`check-${s.id}`,type:"checkbox",name:"check","aria-describedby":"comments-description",class:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 rounded",onChange:n=>l(s)},null,40,Be)])]))),128))]),e("div",{class:"mt-6 flex"},[e("button",{class:"mx-auto flex-shrink-0 px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:j}," Continuar matricula ")])])):S("",!0),t(m)[2].status==="current"?(a(),o("div",Pe,[e("div",{class:"mt-6 flex"},[e("button",{class:"mx-auto flex-shrink-0 px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:M}," Guardar matricula ")]),(a(!0),o(f,null,$(t(v).curso_grupo_list,(s,d)=>(a(),o("div",{key:d},[e("h2",Me,[e("b",null,c(s.curso_nombre),1)]),x(t(ae),{class:"mt-2"},{default:B(()=>[e("div",Se,[(a(!0),o(f,null,$(s.grupos,(n,y)=>(a(),L(t(se),{key:y,as:"template",value:n,class:p([n.checked?"bg-green-50 border-l-8 border-green-400":"",n.numero_registros>=n.limite_registros?"bg-red-50":""]),disabled:n.numero_registros>=n.limite_registros,onClick:N=>P(s,n)},{default:B(({checked:N,active:R})=>[e("div",je,[e("div",De,[e("span",Fe,[x(t(te),{as:"span",class:"font-medium text-gray-900"},{default:B(()=>[V(" Grupo: "),e("b",null,c(n.grupo),1)]),_:2},1024),x(t(z),{as:"span",class:"text-gray-500"},{default:B(()=>[V(" Docente: "),e("span",Ne,[e("b",null,c(n.docente),1)])]),_:2},1024)])]),e("div",Ve,[(a(!0),o(f,null,$(n.horarios,(D,U)=>(a(),o("ul",{key:U},[e("li",null,c(D.dia)+" de "+c(D.hora_inicio)+" a "+c(D.hora_fin),1)]))),128))]),x(t(z),{as:"span",class:"mt-2 flex text-sm sm:mt-0 sm:flex-col sm:ml-4 sm:text-right"},{default:B(()=>[n.numero_registros>=n.limite_registros?(a(),o("div",ze,He)):(a(),o("div",Ae,[e("span",Ge,c(n.numero_registros),1),e("span",Re,"/"+c(n.limite_registros),1)]))]),_:2},1024),e("span",{class:p(["absolute -inset-px rounded-lg pointer-events-none",[R?"border":"border-2",N?"border-indigo-500":"border-transparent"]]),"aria-hidden":"true"},null,2)])]),_:2},1032,["value","class","disabled","onClick"]))),128))])]),_:2},1024)]))),128)),e("div",{class:"mt-6 flex"},[e("button",{class:"mx-auto flex-shrink-0 px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:M}," Guardar matricula ")])])):S("",!0)])])])])):S("",!0)}}),Ue=e("div",{class:"uppercase font-bold text-2xl border-b-2"},[e("h1",null,"Programa Acad\xE9mico")],-1),Oe=["value"],qe={class:"max-w-7xl mx-auto px-4 sm:px-6 md:px-8"},Le={key:0},Te=Z('<div class="text-center"><svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 21h7a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v11m0 5l4.879-4.879m0 0a3 3 0 104.243-4.242 3 3 0 00-4.243 4.242z"></path></svg><h2 class="mt-2 text-lg font-medium text-gray-900"> No ha iniciado matr\xEDcula </h2><p class="mt-1 text-sm text-gray-500"> Por favor haga clic en el bot\xF3n de abajo para iniciar la matr\xEDcula. </p></div>',1),Je={key:1},Ke={class:"text-center"},Qe=e("h2",{class:"mt-2 text-lg font-medium text-gray-900"}," Estudiante ya realiz\xF3 matr\xEDcula ",-1),We=e("p",{class:"mt-1 text-sm text-gray-500"}," Para ver los horarios de clases, por favor haga clic en el bot\xF3n de abajo. ",-1),Xe=e("button",{class:"mx-auto mt-3 flex-shrink-0 px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"}," Ver Horario ",-1),Ye={key:1},as=H({__name:"matricula",setup(F){const i=A(),C=T(),u=J(),m=h(!1),v=h(!1),_=h(!1),E=h(!0),b=h(!1),w=h(""),l=h(0),j=G();K(async()=>{if(_.value=!1,l.value=u.alumno.expedientes[0].id,await i.get_periodo_etapa_active(l.value),await i.get_etapa_active(u.alumno.expedientes[0].programa_id,i.periodo.id,u.alumno.expedientes[0].promocion),!i.etapa.is_active_matricula){k("No se puede matricular, no hay periodo activo",{type:"info",position:"top-right",hideProgressBar:!0}),E.value=!1,_.value=!1;return}await C.get_user_data_by_token(),await u.get_alumno(C.persona_id);const{data:r}=await i.get_matricula_by_expediente_active(l.value);_.value=r,v.value=!0,i.get_horarios_matriculados_by_expediente(l.value,i.periodo.id)});const P=async()=>{const r=u.alumno.expedientes.findIndex(d=>d.id===l.value),s=await i.get_cursos_by_programa_id(u.alumno.expedientes[r].programa_id,u.alumno.expedientes[r].id);if(s.status!==200){k("Error al obtener los cursos",{type:"danger",hideProgressBar:!0});return}i.cursos_list.length>0?m.value=!0:(b.value=!0,w.value=s.data.mensaje)},M=async()=>{const{status:r,data:s}=await j.get_reporte_matricula_pdf(l.value);if(r!==200){k("Error al obtener el reporte",{type:"danger",hideProgressBar:!0});return}const d=document.createElement("a");d.target="_blank",d.href=s.path,d.click()},g=async()=>{E.value=!0,_.value=!1,m.value=!1;const r=u.alumno.expedientes.findIndex(d=>d.id===l.value);if(await i.get_etapa_active(u.alumno.expedientes[r].programa_id,i.periodo.id,u.alumno.expedientes[r].promocion),!i.etapa.is_active){k("No se puede matricular, no hay periodo activo",{type:"info",position:"top-right",hideProgressBar:!0}),_.value=!1,E.value=!1;return}await i.get_cursos_by_programa_id(u.alumno.expedientes[r].programa_id,u.alumno.expedientes[r].id);const{data:s}=await i.get_matricula_by_expediente_active(l.value);_.value=s.length<=0,v.value=!0,await i.get_horarios_matriculados_by_expediente(l.value,i.periodo.id)};return(r,s)=>{const d=O,n=Q("router-link");return a(),o(f,null,[Ue,W(e("select",{"onUpdate:modelValue":s[0]||(s[0]=y=>Y(l)?l.value=y:null),class:"bg-gray-50 border mb-4 border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",onChange:g},[(a(!0),o(f,null,$(t(u).alumno.expedientes,y=>(a(),o("option",{key:y.id,value:y.id},c(y.programa_nombre),9,Oe))),128))],544),[[X,t(l)]]),t(E)?(a(),o("div",{key:0,class:p(t(v)?"block":"hidden")},[e("div",{class:p(t(_)?"block":"hidden")},[e("div",{class:p(["py-6",t(m)?"hidden":"block"])},[e("div",qe,[t(b)===!1?(a(),o("div",Le,[Te,e("div",{class:"mt-6 flex"},[e("button",{class:"mx-auto flex-shrink-0 px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:P}," Iniciar matr\xEDcula ")])])):(a(),o("div",Je,[x(d,{message:t(w)},null,8,["message"])]))])],2),x(I,{class:p(t(m)?"block":"hidden"),expediente:t(l),onFinishMatricula:s[1]||(s[1]=y=>(_.value=!1,m.value=!1))},null,8,["class","expediente"])],2),e("div",{class:p(t(_)?"hidden":"block")},[e("div",{class:p(["mt-6 flex w-full justify-center",t(m)?"hidden":"block"])},[e("div",Ke,[Qe,We,e("button",{class:"mx-auto flex-shrink-0 px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:P}," Modificar Matr\xEDcula "),t(i).curso_grupo_list.length>0?(a(),o("button",{key:0,class:"mx-auto mt-3 flex-shrink-0 px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",onClick:M}," Descargar Ficha de Matricula ")):S("",!0),x(n,{to:"/horarios",class:"mx-2"},{default:B(()=>[Xe]),_:1})])],2),x(I,{class:p(t(m)?"block":"hidden"),expediente:t(l),onFinishMatricula:s[2]||(s[2]=y=>(_.value=!1,m.value=!1))},null,8,["class","expediente"])],2)],2)):(a(),o("div",Ye,[x(d,{message:"El periodo de matriculas ya finaliz\xF3!"})]))],64)}}});export{as as default};
