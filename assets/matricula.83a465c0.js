import{_ as G}from"./alert.e31afa60.js";import{d as V,b as f,u as z,X as U,k as I,h as g,o as a,f as o,g as e,F as h,i as w,q as y,m as v,j as l,p as j,n as C,c as q,l as H,t as b,x as L,a as T,e as X,r as J,w as K,v as O,z as Q}from"./index.ce6d7a49.js";import{r as W}from"./CheckIcon.a21844ba.js";import{R as Y,g as N,b as Z,v as ee}from"./radio-group.94588419.js";const se={key:0,class:"flex flex-col"},te={class:"flex-1"},ae={class:"py-6"},oe={class:"max-w-7xl mx-auto px-4 sm:px-6 md:px-8"},re={class:"flex items-center justify-center","aria-label":"Progress"},ie={role:"list",class:"flex items-center"},ne=e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"h-0.5 w-full bg-indigo-600"})],-1),le={class:"relative w-8 h-8 flex items-center justify-center bg-indigo-600 rounded-full hover:bg-indigo-900"},de={class:"sr-only"},ce=e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"h-0.5 w-full bg-gray-200"})],-1),ue={href:"#",class:"relative w-8 h-8 flex items-center justify-center bg-white border-2 border-indigo-600 rounded-full","aria-current":"step"},me=e("span",{class:"h-2.5 w-2.5 bg-indigo-600 rounded-full","aria-hidden":"true"},null,-1),_e={class:"sr-only"},ge=e("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[e("div",{class:"h-0.5 w-full bg-gray-200"})],-1),he={href:"#",class:"group relative w-8 h-8 flex items-center justify-center bg-white border-2 border-gray-300 rounded-full hover:border-gray-400"},fe=e("span",{class:"h-2.5 w-2.5 bg-transparent rounded-full group-hover:bg-gray-300","aria-hidden":"true"},null,-1),pe={class:"sr-only"},xe={key:0},ve={class:"divide-y divide-gray-200"},be={class:"min-w-0 flex-1 text-sm"},ye=["for"],ke={id:"comments-description",class:"text-gray-500 flex gap-2"},we={class:"ml-3 flex items-center h-5"},Ce=["id","onChange"],$e={key:1,class:"flex flex-col space-y-4 mt-10"},Ee={class:"text-lg leading-6 font-medium text-gray-900 uppercase"},Pe={class:"space-y-4"},Be={class:"relative block bg-white border rounded-lg shadow-sm px-6 py-4 cursor-pointer sm:flex sm:justify-between focus:outline-none"},Se={class:"flex items-center"},je={class:"text-sm flex flex-col"},Me=H(" Grupo: "),De=H(" Docente: "),Fe={class:"block sm:inline"},Ne={class:"text-xs"},Ve={key:0},ze=e("span",{class:"text-red-500"},[e("b",null," No hay cupo disponible ")],-1),Ie=[ze],He={key:1},Re={class:"font-medium text-gray-900"},Ae={class:"ml-1 text-gray-500 sm:ml-0"},Ge=V({props:{expediente:null},emits:["finishMatricula"],setup(F,{emit:i}){const $=F,r=f([{id:"01",name:"Iniciar",description:"",href:"",status:"complete"},{id:"02",name:"Cursos",description:"",href:"cursos",status:"current"},{id:"03",name:"Horarios",description:"",href:"horarios",status:"upcoming"}]),u=z(),E=U(),m=I(),_=f([]),k=f(!1),P=c=>{_.value.includes(c.id)?_.value=_.value.filter(p=>p!==c.id):_.value.push(c.id)},d=async()=>{if(_.value.length===0)b("Debe selecionar al menos un curso para continuar",{type:"danger",hideProgressBar:!0});else{r.value[1].status="complete",r.value[2].status="current";const{status:c}=await u.get_cursos_grupos_by_cursos(_.value);c!==200&&b("Error al obtener los cursos",{type:"danger",hideProgressBar:!0})}},B=(c,p)=>{if(p.numero_registros>=p.limite_registros){b("El grupo seleccionado ya est\xE1 lleno",{type:"danger",hideProgressBar:!0});return}c.grupos.forEach(s=>{s.checked=!1}),p.checked=!p.checked},S=async()=>{if(k.value)return;k.value=!0;const{status:c}=await u.save_cursos_grupos($.expediente);if(c!==201){b("Error al guardar los cursos",{type:"danger",hideProgressBar:!0}),k.value=!1;return}b("Matricula Completada Correctamente!",{type:"success",hideProgressBar:!0}),m.get_reporte_matricula_pdf($.expediente),i("finishMatricula",!0),E.push("/horarios"),k.value=!0};return(c,p)=>g(u).get_cursos_list.length>0?(a(),o("div",se,[e("main",te,[e("div",ae,[e("div",oe,[e("nav",re,[e("ol",ie,[(a(!0),o(h,null,w(r.value,(s,n)=>(a(),o("li",{key:s.name,class:y(["relative",[n!==r.value.length-1?"pr-8 sm:pr-20":""]])},[s.status==="complete"?(a(),o(h,{key:0},[ne,e("a",le,[v(g(W),{class:"w-5 h-5 text-white","aria-hidden":"true"}),e("span",de,l(s.name),1)])],64)):s.status==="current"?(a(),o(h,{key:1},[ce,e("a",ue,[me,e("span",_e,l(s.name),1)])],64)):(a(),o(h,{key:2},[ge,e("a",he,[fe,e("span",pe,l(s.name),1)])],64))],2))),128))])]),r.value[1].status==="current"?(a(),o("div",xe,[e("div",ve,[(a(!0),o(h,null,w(g(u).get_cursos_list,(s,n)=>(a(),o("div",{key:n,class:"relative flex items-start py-4"},[e("div",be,[e("label",{for:`check-${s.id}`,class:"font-medium text-gray-700 w-full"},[e("b",null,l(s.nombre)+" ("+l(s.codigo)+")",1)],8,ye),e("p",ke,[e("span",null,"Ciclo: "+l(s.ciclo),1),e("span",null,"Creditos: "+l(s.creditos),1)])]),e("div",we,[e("input",{id:`check-${s.id}`,type:"checkbox",name:"check","aria-describedby":"comments-description",class:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 rounded",onChange:t=>P(s)},null,40,Ce)])]))),128))]),e("div",{class:"mt-6 flex"},[e("button",{class:"mx-auto flex-shrink-0 px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:d}," Continuar matricula ")])])):j("",!0),r.value[2].status==="current"?(a(),o("div",$e,[e("div",{class:"mt-6 flex"},[e("button",{class:"mx-auto flex-shrink-0 px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:S}," Guardar matricula ")]),(a(!0),o(h,null,w(g(u).curso_grupo_list,(s,n)=>(a(),o("div",{key:n},[e("h2",Ee,[e("b",null,l(s.curso_nombre),1)]),v(g(ee),{class:"mt-2"},{default:C(()=>[e("div",Pe,[(a(!0),o(h,null,w(s.grupos,(t,M)=>(a(),q(g(Z),{key:M,as:"template",value:t,class:y([t.checked?"bg-green-50 border-l-8 border-green-400":"",t.numero_registros>=t.limite_registros?"bg-red-50":""]),disabled:t.numero_registros>=t.limite_registros,onClick:x=>B(s,t)},{default:C(({checked:x,active:R})=>[e("div",Be,[e("div",Se,[e("span",je,[v(g(Y),{as:"span",class:"font-medium text-gray-900"},{default:C(()=>[Me,e("b",null,l(t.grupo),1)]),_:2},1024),v(g(N),{as:"span",class:"text-gray-500"},{default:C(()=>[De,e("span",Fe,[e("b",null,l(t.docente),1)])]),_:2},1024)])]),e("div",Ne,[(a(!0),o(h,null,w(t.horarios,(D,A)=>(a(),o("ul",{key:A},[e("li",null,l(D.dia)+" de "+l(D.hora_inicio)+" a "+l(D.hora_fin),1)]))),128))]),v(g(N),{as:"span",class:"mt-2 flex text-sm sm:mt-0 sm:flex-col sm:ml-4 sm:text-right"},{default:C(()=>[t.numero_registros>=t.limite_registros?(a(),o("div",Ve,Ie)):(a(),o("div",He,[e("span",Re,l(t.numero_registros),1),e("span",Ae,"/"+l(t.limite_registros),1)]))]),_:2},1024),e("span",{class:y(["absolute -inset-px rounded-lg pointer-events-none",[R?"border":"border-2",x?"border-indigo-500":"border-transparent"]]),"aria-hidden":"true"},null,2)])]),_:2},1032,["value","class","disabled","onClick"]))),128))])]),_:2},1024)]))),128)),e("div",{class:"mt-6 flex"},[e("button",{class:"mx-auto flex-shrink-0 px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:S}," Guardar matricula ")])])):j("",!0)])])])])):j("",!0)}}),Ue=e("div",{class:"uppercase font-bold text-2xl border-b-2"},[e("h1",null,"Programa Acad\xE9mico")],-1),qe=["value"],Le={class:"max-w-7xl mx-auto px-4 sm:px-6 md:px-8"},Te={key:0},Xe=Q('<div class="text-center"><svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 21h7a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v11m0 5l4.879-4.879m0 0a3 3 0 104.243-4.242 3 3 0 00-4.243 4.242z"></path></svg><h2 class="mt-2 text-lg font-medium text-gray-900"> No ha iniciado matr\xEDcula </h2><p class="mt-1 text-sm text-gray-500"> Por favor haga clic en el bot\xF3n de abajo para iniciar la matr\xEDcula. </p></div>',1),Je={key:1},Ke={class:"mt-6 flex w-full justify-center"},Oe={class:"text-center"},Qe=e("h2",{class:"mt-2 text-lg font-medium text-gray-900"}," Estudiante ya realiz\xF3 matr\xEDcula ",-1),We=e("p",{class:"mt-1 text-sm text-gray-500"}," Para ver los horarios de clases, por favor haga clic en el bot\xF3n de abajo. ",-1),Ye=e("button",{class:"mx-auto mt-3 flex-shrink-0 px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"}," Ver Horario ",-1),Ze={key:1},os=V({setup(F){const i=z(),$=L(),r=T(),u=f(!1),E=f(!1),m=f(!1),_=f(!0),k=f(!1),P=f(""),d=f(0),B=I();X(async()=>{if(m.value=!1,await i.get_periodo_active(),d.value=r.alumno.expedientes[0].id,await i.get_etapa_active(r.alumno.expedientes[0].programa_id,i.periodo.id,r.alumno.expedientes[0].promocion),!i.etapa.is_active){b("No se puede matricular, no hay periodo activo",{type:"info",position:"top-right",hideProgressBar:!0}),m.value=!1,_.value=!1;return}await $.get_user_data_by_token(),await r.get_alumno($.persona_id);const{data:s}=await i.get_matricula_by_expediente_active(d.value);m.value=s.length<=0,E.value=!0,i.get_horarios_matriculados_by_expediente(d.value)});const S=async()=>{const s=r.alumno.expedientes.findIndex(t=>t.id===d.value),n=await i.get_cursos_by_programa_id(r.alumno.expedientes[s].programa_id,r.alumno.expedientes[s].id);if(n.status!==200){b("Error al obtener los cursos",{type:"danger",hideProgressBar:!0});return}i.cursos_list.length>0?u.value=!0:(k.value=!0,P.value=n.data.mensaje)},c=async()=>{const{status:s,data:n}=await B.get_reporte_matricula_pdf(d.value);if(s!==200){b("Error al obtener el reporte",{type:"danger",hideProgressBar:!0});return}const t=document.createElement("a");t.target="_blank",t.href=B.get_media_url(n.path),t.click()},p=async()=>{_.value=!0,m.value=!1,u.value=!1;const s=r.alumno.expedientes.findIndex(t=>t.id===d.value);if(await i.get_etapa_active(r.alumno.expedientes[s].programa_id,i.periodo.id,r.alumno.expedientes[s].promocion),!i.etapa.is_active){b("No se puede matricular, no hay periodo activo",{type:"info",position:"top-right",hideProgressBar:!0}),m.value=!1,_.value=!1;return}await i.get_cursos_by_programa_id(r.alumno.expedientes[s].programa_id,r.alumno.expedientes[s].id);const{data:n}=await i.get_matricula_by_expediente_active(d.value);m.value=n.length<=0,E.value=!0,await i.get_horarios_matriculados_by_expediente(d.value)};return(s,n)=>{const t=G,M=J("router-link");return a(),o(h,null,[Ue,K(e("select",{"onUpdate:modelValue":n[0]||(n[0]=x=>d.value=x),class:"bg-gray-50 border mb-4 border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",onChange:p},[(a(!0),o(h,null,w(g(r).alumno.expedientes,x=>(a(),o("option",{key:x.id,value:x.id},l(x.programa_nombre),9,qe))),128))],544),[[O,d.value]]),_.value?(a(),o("div",{key:0,class:y(E.value?"block":"hidden")},[e("div",{class:y(m.value?"block":"hidden")},[e("div",{class:y(["py-6",u.value?"hidden":"block"])},[e("div",Le,[k.value===!1?(a(),o("div",Te,[Xe,e("div",{class:"mt-6 flex"},[e("button",{class:"mx-auto flex-shrink-0 px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:S}," Iniciar matr\xEDcula ")])])):(a(),o("div",Je,[v(t,{message:P.value},null,8,["message"])]))])],2),v(Ge,{class:y(u.value?"block":"hidden"),expediente:d.value,onFinishMatricula:n[1]||(n[1]=x=>(m.value=!1,u.value=!1))},null,8,["class","expediente"])],2),e("div",{class:y(m.value?"hidden":"block")},[e("div",Ke,[e("div",Oe,[Qe,We,g(i).curso_grupo_list.length>0?(a(),o("button",{key:0,class:"mx-auto mt-3 flex-shrink-0 px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",onClick:c}," Descargar Ficha de Matricula ")):j("",!0),v(M,{to:"/horarios",class:"mx-2"},{default:C(()=>[Ye]),_:1})])])],2)],2)):(a(),o("div",Ze,[v(t,{message:"El periodo de matriculas ya finaliz\xF3!"})]))],64)}}});export{os as default};
